<!-- Check if loggedin user has clearance to view this page -->
<% if(loggedinUser.userType === 2) { %>

<%- include ./header %>


<div class="container-flex col-md-10 no-gutters">

   <div class="navbar navbar-expand bg-dark navbar-dark">
      <div class="navbar-collapse col-md-6">
         <ul class="navbar-nav">
            <li class="nav-item">
               <a class="nav-link disabled text-primary" tabindex="-1" aria-disabled="true" href="#"
                  style="min-width: 200px;;">Welcome
                  <%= loggedinUser.name %>
               </a>
            </li>
         </ul>
      </div>
      <div class="col-md-6 m-0 p-0">
         <% include ../../partials/errors %>
      </div>
   </div>

   <!-- Start Container -->
   <div class="container-flex col-md-12 overflow-auto" style="max-height: 2000px;">


      <!-- Start Row 1 -->
      <div class="row text-center col-md-12 mt-5">
         <div class="row col-md-12 mb-5">
            <h1>Stakeholders Information Management</h1>
         </div>
         <div class="row card col-md-2 mx-auto p-0" style="background: rgba(255, 99, 132, 0.1)">
            <div class="card-body col-md-12">
               <h5 class="mt-4 pt-2">Total Admins</h5>
            </div>
            <div class="card-body col-md-12 bg-dark">

               <h2 class="text-white"><%= countAdmins %></h2>
            </div>
         </div>

         <div class="row card col-md-2 mx-auto p-0" style="background: rgba(1, 152, 253, 0.2)">
            <div class="card-body col-md-12">
               <h5 class="mt-4 pt-2">Total Sellers</h5>
            </div>
            <div class="card-body col-md-12 bg-dark">

               <h2 class="text-white"><%= countSellers %></h2>
            </div>
         </div>

         <div class="row card col-md-2 mx-auto p-0" style="background: rgba(246, 246, 44, 0.1)">
            <div class="card-body col-md-12">
               <h5 class="mt-4 pt-2">Total Shoppers</h5>
            </div>
            <div class="card-body col-md-12 bg-dark">

               <h2 class="text-white"><%= countShoppers %></h2>
            </div>
         </div>

         <div class="row col-md-5 mx-auto">
            <canvas id="myChart" width="400" height="200"></canvas>
         </div>
      </div>
      <!-- End Row 1 -->



      <!-- Chart -->
      <div class="row col-md-12 mt-5">
         <div class="row col-md-12 mx-auto py-5">
            <canvas id="myChart2" width="400" height="120"></canvas>
         </div>
      </div>
      <!-- Chart End -->



      <!-- Start Row 2 -->
      <div class="row text-center col-md-12 mt-5">
         <div class="row col-md-12 mb-5">
            <h1>Market Information Management</h1>
         </div>
         <div class="row card col-md-2 mx-auto p-0" style="background: rgba(127, 167, 241, 0.2)">
            <div class="card-body col-md-12 ">
               <h5 class="mt-4 pt-2">Total Products</h5>
            </div>
            <div class="card-body col-md-12 bg-dark">
               <h2 class="text-white"><%= countItems %></h2>
            </div>
         </div>

         <div class="row card col-md-2 mx-auto p-0" style="background: rgba(245, 102, 126, 0.2)">
            <div class="card-body col-md-12">
               <h5 class="mt-4 pt-2">Most Expensive</h5>
            </div>
            <div class="card-body col-md-12 bg-dark">
               <h2 class="text-white">€ <%= mostExpensive %></h2>
            </div>
         </div>

         <div class="row card col-md-2 mx-auto p-0" style="background: rgba(2, 161, 2, 0.2)">
            <div class="card-body col-md-12 ">
               <h5 class="mt-4 pt-2">Total Prod Value</h5>
            </div>
            <div class="card-body col-md-12 bg-dark">

               <h2 class="text-white">€ <%= total %></h2>
            </div>
         </div>
         <div class="row col-md-5 mx-auto">
            <canvas id="myChart3" width="400" height="200"></canvas>
         </div>
         <!-- End Row 2 -->
      </div>


   </div>
   <!-- End Container -->
   <br>
   <br>
   <br>
   <br>
   <br>
   <br>
   <br>
   <br>
</div>





<script>

   const ctx = document.getElementById('myChart').getContext('2d');
   const myChart = new Chart(ctx, {
      type: 'pie',
      data: {
         labels: ['Admins', 'Sellers', 'Shoppers'],
         datasets: [{
            data: [<%= countAdmins %>, <%= countSellers %>, <%= countShoppers %>],
            backgroundColor: [
               'rgba(255, 99, 132, 0.2)',
               'rgba(54, 162, 235, 0.2)',
               'rgba(255, 206, 86, 0.2)',
            ],
            borderColor: [
               'rgba(0, 0, 0, 0.5)',
               'rgba(0, 0, 0, 0.5)',
               'rgba(0, 0, 0, 0.5)'
            ],
            borderWidth: 0.4
         }]
      }

   });

   const ctx2 = document.getElementById('myChart2').getContext('2d');
   var myChart2 = new Chart(ctx2, {
      type: 'bar',
      data: {
         labels: ['', 'Spending', 'Income', ''],
         datasets: [{
            label: 'To Much Spending',
            data: [10, <%= countAdmins %>, <%= countShoppers %>, 0],
            backgroundColor: [
               'rgba(0,0,0,0)',
               'rgba(255, 99, 132, 0.<%= countAdmins %>)',
               'rgba(75, 192, 192, 0.6)',
               ''
            ],
            borderWidth: 1
         }]
      }
   });

   const ctx3 = document.getElementById('myChart3').getContext('2d');
   var myChart3 = new Chart(ctx3, {
      type: 'pie',
      data: {
         labels: ['Global Market Size', 'Our Slice'],
         datasets: [{
            label: 'IoT Market Size vs Our Inventory Value',
            data: [200000, <%= total %>],
            backgroundColor: [
               'rgba(153, 102, 255, 0.2)',
               'orange'
            ],
            borderWidth: 1
         }]
      }
   });



</script>

<%- include ./footer %>

<% } else { %>
<%- include ../partials/unauthorised-access %>
<% } %>